<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" class="light" lang="es">

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title th:text="${proyecto.idProyecto != null ? 'Editar Proyecto' : 'Nuevo Proyecto'} + ' - SC LLAMKAY SAC'">
        Proyecto - SC LLAMKAY SAC</title>
    <link rel="icon" type="image/png" th:href="@{/img/Logo.png}"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap"
          rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#1193d4",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101c22",
                    },
                    fontFamily: { "display": ["Manrope", "sans-serif"] },
                    borderRadius: { "DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px" },
                },
            },
        }
    </script>
</head>

<body class="bg-background-light dark:bg-background-dark font-display text-[#111618] dark:text-gray-200">
<div class="relative flex min-h-screen w-full flex-col items-center justify-center p-4 sm:p-6 group/design-root">
    <div aria-hidden="true" class="fixed inset-0 bg-gray-900/40 dark:bg-gray-900/60 backdrop-blur-sm"></div>

    <!-- FORMULARIO -->
    <form th:action="@{/proyectos/guardar}" method="post" th:object="${proyecto}"
          class="relative w-full max-w-4xl bg-white dark:bg-[#18262f] rounded-xl shadow-2xl overflow-hidden my-8">

        <!-- Header -->
        <div class="p-6 sm:p-8 border-b border-gray-200 dark:border-gray-700">
            <div class="flex flex-wrap justify-between items-start gap-3">
                <div class="flex flex-col gap-1">
                    <p class="text-[#111618] dark:text-white text-2xl sm:text-3xl font-black leading-tight tracking-[-0.03em]"
                       th:text="${proyecto.idProyecto != null ? 'Editar Proyecto' : 'Nuevo Proyecto'}">Nuevo
                        Proyecto</p>
                    <p class="text-[#617c89] dark:text-gray-400 text-sm sm:text-base font-normal leading-normal">
                        Complete los detalles del proyecto.</p>
                </div>
                <a th:href="${proyecto.idProyecto != null ? '/proyectos/detalle/' + proyecto.idProyecto : '/principal'}"
                   class="p-2 rounded-full text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                    <span class="material-symbols-outlined">close</span>
                </a>
            </div>
        </div>

        <!-- Body -->
        <div class="p-6 sm:p-8 max-h-[calc(100vh-220px)] overflow-y-auto">
            <div class="flex flex-col gap-8">
                <!-- Informaci√≥n General -->
                <div>
                    <h3
                            class="text-[#111618] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] pb-4">
                        Informaci√≥n General</h3>
                    <div class="grid grid-cols-1 gap-6">
                        <!-- ID oculto -->
                        <input type="hidden" th:field="*{idProyecto}" />

                        <!-- Nombre -->
                        <label class="flex flex-col w-full">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                T√≠tulo del Proyecto <span class="text-red-500">*</span></p>
                            <input th:field="*{nombre}" required
                                   class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary h-14 placeholder:text-[#617c89] p-[15px] text-base font-normal leading-normal transition-shadow"
                                   placeholder="Ej. Desarrollo de la nueva plataforma" />
                        </label>

                        <!-- Descripci√≥n -->
                        <label class="flex flex-col w-full">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                Descripci√≥n</p>
                            <textarea th:field="*{descripcion}" rows="4"
                                      class="form-textarea flex w-full min-w-0 flex-1 resize-y overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary placeholder:text-[#617c89] p-[15px] text-base font-normal leading-normal transition-shadow"
                                      placeholder="Ingrese una descripci√≥n detallada del proyecto"></textarea>
                        </label>
                    </div>
                </div>

                <!-- Planificaci√≥n -->
                <div>
                    <h3
                            class="text-[#111618] dark:text-white text-lg font-bold leading-tight tracking-[-0.015em] pb-4">
                        Planificaci√≥n y Presupuesto</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Fecha Inicio -->
                        <label class="flex flex-col w-full">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                Fecha de Inicio <span class="text-red-500">*</span></p>
                            <input th:field="*{fechaInicio}" required
                                   class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary h-14 placeholder:text-[#617c89] p-[15px] text-base font-normal leading-normal transition-shadow"
                                   type="date" />
                        </label>

                        <!-- Fecha Fin -->
                        <label class="flex flex-col w-full">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                Fecha de Fin</p>
                            <input th:field="*{fechaFin}"
                                   class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary h-14 placeholder:text-[#617c89] p-[15px] text-base font-normal leading-normal transition-shadow"
                                   type="date" />
                        </label>

                        <!-- Estado -->
                        <label class="flex flex-col w-full">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                Estado del Proyecto <span class="text-red-500">*</span></p>
                            <div class="relative">
                                <select th:field="*{estado}" required
                                        class="form-select appearance-none flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary h-14 placeholder:text-[#617c89] p-[15px] text-base font-normal leading-normal transition-shadow pr-12">
                                    <option value="Planificado">Planificado</option>
                                    <option value="En Curso">En Curso</option>
                                    <option value="Pausado">Pausado</option>
                                    <option value="Completado">Completado</option>
                                </select>
                            </div>
                        </label>

                        <!-- Cliente -->
                        <label class="flex flex-col w-full">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                Cliente <span class="text-red-500">*</span></p>
                            <div class="relative">
                                <select th:field="*{cliente.idCliente}" required
                                        class="form-select appearance-none flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary h-14 placeholder:text-[#617c89] p-[15px] text-base font-normal leading-normal transition-shadow pr-12">
                                    <option value="">Seleccione un cliente</option>
                                    <option th:each="cliente : ${clientes}" th:value="${cliente.idCliente}"
                                            th:text="${cliente.nombre}">Cliente</option>
                                </select>
                            </div>
                        </label>

                        <!-- ‚úÖ NUEVO: Presupuesto Total -->
                        <label class="flex flex-col w-full md:col-span-2">
                            <p class="text-[#111618] dark:text-gray-300 text-base font-medium leading-normal pb-2">
                                Presupuesto Total Estimado</p>
                            <div class="relative">
                                <span class="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 font-semibold">$</span>
                                <input th:field="*{presupuestoTotal}" type="number" step="0.01" min="0"
                                       class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg text-[#111618] dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dbe2e6] dark:border-gray-600 bg-white dark:bg-gray-800 focus:border-primary h-14 placeholder:text-[#617c89] pl-8 pr-4 py-[15px] text-base font-normal leading-normal transition-shadow"
                                       placeholder="50,000.00" />
                            </div>
                            <p class="text-xs text-[#617c89] dark:text-gray-400 mt-1">
                                üí° Opcional. Puedes calcularlo autom√°ticamente sumando los costos de los servicios asignados.
                            </p>
                        </label>
                    </div>
                </div>

                <!-- Nota informativa -->
                <div
                        class="bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4">
                    <div class="flex gap-3">
                        <span class="material-symbols-outlined text-blue-600 dark:text-blue-400">info</span>
                        <div>
                            <p class="text-sm font-semibold text-blue-900 dark:text-blue-200 mb-1">
                                Gesti√≥n de Servicios y Personal
                            </p>
                            <p class="text-sm text-blue-700 dark:text-blue-300">
                                Despu√©s de guardar el proyecto, podr√°s asignar servicios del cat√°logo y gestionar el personal desde la vista de detalle.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer con botones -->
        <div
                class="flex flex-col sm:flex-row justify-end items-center gap-4 p-6 sm:p-8 bg-gray-50 dark:bg-black/20 border-t border-gray-200 dark:border-gray-700">
            <a th:href="${proyecto.idProyecto != null ? '/proyectos/detalle/' + proyecto.idProyecto : '/principal'}"
               class="w-full sm:w-auto px-6 py-3 rounded-lg text-center font-semibold text-[#111618] dark:text-white bg-transparent hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                Cancelar
            </a>
            <button type="submit"
                    class="w-full sm:w-auto px-6 py-3 rounded-lg text-center font-semibold text-white bg-primary hover:bg-primary/90 transition-colors shadow-sm">
                    <span th:text="${proyecto.idProyecto != null ? 'Actualizar Proyecto' : 'Crear Proyecto'}">Crear
                        Proyecto</span>
            </button>
        </div>
    </form>
</div>
</body>

</html>